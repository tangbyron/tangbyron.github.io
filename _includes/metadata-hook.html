<!-- Open Graph and Twitter Card for social media previews -->
{% if page.url contains 'recursive-lm-code-execution' %}
  <meta property="og:image" content="https://tangbyron.github.io/assets/img/posts/2025-11-22-recursive-lm-code-execution.jpg">
  <meta name="twitter:image" content="https://tangbyron.github.io/assets/img/posts/2025-11-22-recursive-lm-code-execution.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:description" content="Part 3 in an ongoing series on continual learning for LLM agents: from Reasoning Banks → Recursive Language Models → RLM + Code Execution.">
  <meta name="twitter:description" content="Part 3 in an ongoing series on continual learning for LLM agents: from Reasoning Banks → Recursive Language Models → RLM + Code Execution.">
{% endif %}

<!-- Custom CSS for code block formatting - embedded inline -->
<style>
/* Fix code block formatting with ultra-high specificity */
main article div.content div.highlight > code,
main article div.content div.highlight > pre,
main article div.content div.highlight > pre > code,
main article div.content .highlighter-rouge .highlight code,
main article div.content .highlighter-rouge .highlight pre,
article.px-1 div.content div.highlight code,
article div.content div.highlighter-rouge code,
div.highlight > code,
div.highlight > pre,
div.highlight > pre > code,
.highlighter-rouge .highlight code,
.highlighter-rouge .highlight pre,
.content div.highlight code,
.content div.highlight pre {
  white-space: pre !important;
  overflow-x: auto !important;
  word-break: normal !important;
  word-wrap: normal !important;
  overflow-wrap: normal !important;
  display: block !important;
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;
  line-height: 1.6 !important;
}

/* Add padding to code blocks for professional spacing */
div.highlight > code,
.highlighter-rouge .highlight code {
  padding: 1em !important;
  padding-right: 1.5em !important; /* Extra space to avoid overlap with scrollbar */
}

/* Style the code header and copy button */
.code-header {
  background-color: rgba(128, 128, 128, 0.1) !important;
  padding: 0.5em 1em !important;
  border-bottom: 1px solid rgba(128, 128, 128, 0.2) !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
}

/* Make copy button more prominent and interactive */
.code-header button {
  opacity: 0.6 !important;
  transition: opacity 0.2s ease !important;
  cursor: pointer !important;
  background: none !important;
  border: none !important;
  padding: 0.25em 0.5em !important;
  border-radius: 4px !important;
  color: inherit !important;
}

.code-header button:hover {
  opacity: 1 !important;
  background-color: rgba(128, 128, 128, 0.15) !important;
}

/* Success state for copy button */
.code-header button.copied {
  color: #28a745 !important;
}

/* Label styling */
.code-header span[data-label-text] {
  font-size: 0.875em !important;
  opacity: 0.7 !important;
}

/* Mermaid diagrams - white background for readability in both themes */
.mermaid {
  background-color: white !important;
  padding: 2em !important;
  margin: 1.5em 0 !important;
  border-radius: 8px !important;
  overflow-x: auto !important;
  text-align: center !important;
}

.mermaid svg {
  max-width: 100% !important;
  height: auto !important;
}
</style>

<script>
// Copy to clipboard functionality for code blocks
document.addEventListener('DOMContentLoaded', function() {
  const copyButtons = document.querySelectorAll('.code-header button[aria-label="copy"]');
  
  copyButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      e.preventDefault();
      
      // Find the code block associated with this button
      const codeBlock = this.closest('.highlighter-rouge').querySelector('code');
      if (!codeBlock) return;
      
      const textToCopy = codeBlock.textContent;
      
      // Copy to clipboard
      navigator.clipboard.writeText(textToCopy).then(() => {
        // Visual feedback
        const originalHTML = this.innerHTML;
        this.classList.add('copied');
        this.innerHTML = '<i class="fas fa-check"></i>';
        
        // Show success tooltip
        const originalTitle = this.getAttribute('aria-label');
        this.setAttribute('aria-label', this.getAttribute('data-title-succeed') || 'Copied!');
        
        // Reset after 2 seconds
        setTimeout(() => {
          this.classList.remove('copied');
          this.innerHTML = originalHTML;
          this.setAttribute('aria-label', originalTitle);
        }, 2000);
      }).catch(err => {
        console.error('Failed to copy:', err);
        // Fallback: show error state briefly
        const originalHTML = this.innerHTML;
        this.innerHTML = '<i class="fas fa-times"></i>';
        setTimeout(() => {
          this.innerHTML = originalHTML;
        }, 2000);
      });
    });
  });
});
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
<script defer>
(function() {
  function transformAndRenderMermaid() {
    // Replace Rouge-wrapped mermaid blocks with <div class="mermaid">...</div>
    document.querySelectorAll('div.language-mermaid').forEach(function(wrapper) {
      var codeEl = wrapper.querySelector('pre code');
      if (!codeEl) return;
      var container = document.createElement('div');
      container.className = 'mermaid';
      container.textContent = (codeEl.textContent || '').trim();
      wrapper.replaceWith(container);
    });

    // Fallback: handle <pre><code class="language-mermaid">...</code></pre>
    document.querySelectorAll('pre > code.language-mermaid').forEach(function(code) {
      var pre = code.parentElement;
      if (!pre) return;
      var container = document.createElement('div');
      container.className = 'mermaid';
      container.textContent = (code.textContent || '').trim();
      pre.replaceWith(container);
    });

    if (window.mermaid) {
      try {
        var isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        window.mermaid.initialize({
          startOnLoad: false,
          securityLevel: 'loose',
          theme: isDark ? 'dark' : 'default'
        });
        window.mermaid.run({ querySelector: '.mermaid' });
      } catch (e) {
        console.error('Mermaid initialization failed:', e);
      }
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', transformAndRenderMermaid);
  } else {
    transformAndRenderMermaid();
  }
})();
</script>
